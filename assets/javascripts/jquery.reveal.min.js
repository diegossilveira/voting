(function(a){a("a[data-reveal-id]").live("click",function(b){b.preventDefault();var c=a(this).attr("data-reveal-id");a("#"+c).reveal(a(this).data())});a.fn.reveal=function(b){var c={animation:"fadeAndPop",animationspeed:300,closeonbackgroundclick:true,dismissmodalclass:"close-reveal-modal"};var b=a.extend({},c,b);return this.each(function(){function i(){f=false}function j(){f=true}var c=a(this),d=parseInt(c.css("top")),e=c.height()+d,f=false,g=a(".reveal-modal-bg");if(g.length==0){g=a('<div class="reveal-modal-bg" />').insertAfter(c)}c.bind("reveal:open",function(){g.unbind("click.modalEvent");a("."+b.dismissmodalclass).unbind("click.modalEvent");if(!f){j();if(b.animation=="fadeAndPop"){c.css({top:a(document).scrollTop()-e,opacity:0,visibility:"visible"});g.fadeIn(b.animationspeed/2);c.delay(b.animationspeed/2).animate({top:a(document).scrollTop()+d+"px",opacity:1},b.animationspeed,i())}if(b.animation=="fade"){c.css({opacity:0,visibility:"visible",top:a(document).scrollTop()+d});g.fadeIn(b.animationspeed/2);c.delay(b.animationspeed/2).animate({opacity:1},b.animationspeed,i())}if(b.animation=="none"){c.css({visibility:"visible",top:a(document).scrollTop()+d});g.css({display:"block"});i()}}c.unbind("reveal:open")});c.bind("reveal:close",function(){if(!f){j();if(b.animation=="fadeAndPop"){g.delay(b.animationspeed).fadeOut(b.animationspeed);c.animate({top:a(document).scrollTop()-e+"px",opacity:0},b.animationspeed/2,function(){c.css({top:d,opacity:1,visibility:"hidden"});i()})}if(b.animation=="fade"){g.delay(b.animationspeed).fadeOut(b.animationspeed);c.animate({opacity:0},b.animationspeed,function(){c.css({opacity:1,visibility:"hidden",top:d});i()})}if(b.animation=="none"){c.css({visibility:"hidden",top:d});g.css({display:"none"})}}c.unbind("reveal:close")});c.trigger("reveal:open");var h=a("."+b.dismissmodalclass).bind("click.modalEvent",function(){c.trigger("reveal:close")});if(b.closeonbackgroundclick){g.css({cursor:"pointer"});g.bind("click.modalEvent",function(){c.trigger("reveal:close")})}a("body").keyup(function(a){if(a.which===27){c.trigger("reveal:close")}})})}})(jQuery)